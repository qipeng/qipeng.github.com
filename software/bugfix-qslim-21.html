﻿<html lang="en">
<head>
    <meta charset="">

  <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="">

  <!-- encoding must be specified within the first 512 bytes
        www.whatwg.org/specs/web-apps/current-work/multipage/semantics.html#charset -->

  <!-- meta element for compatibility mode needs to be before
        all elements except title & meta
        msdn.microsoft.com/en-us/library/cc288325(VS.85).aspx -->
  <!-- Chrome Frame is only invoked if meta element for
        compatibility mode is within the first 1K bytes
        code.google.com/p/chromium/issues/detail?id=23003 -->

  <title>An Unofficial "Bugfix" for QSlim 2.1</title>
  <meta name="description" content="A bugfix for QSlim 2.1, resolving the problem of redundant planes.
">
  <meta name="author" content="Peng Qi">

  <!--  Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="">

    <link rel="shortcut icon" href="/favicon.ico">
  
  <link href='http://fonts.googleapis.com/css?family=Poly|Open+Sans' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/media/css/site.css" type="text/css">
  <link rel="stylesheet" href="/media/css/syntax.css" type="text/css">
  <link rel="stylesheet" href="/media/js/fancybox/jquery.fancybox-1.3.4.css" type="text/css">
  <link rel="stylesheet" href="/media/css/syntaxhighlighter/shCoreEclipse.css" type="text/css">
<link rel="stylesheet" href="/media/css/syntaxhighlighter/shThemeEclipse.css" type="text/css">

    <!-- All JavaScript at the bottom, except for Modernizr which
        enables HTML5 elements & feature detects -->
    <script type="text/javascript" src="/media/js/libs/modernizr-1.7.min.js"></script>
    </head>
<body id="bugfix-qslim-21">
    <div id="container">
            <div id="main" role="main">
          <header class="banner clearfix">
          <h1>Peng Qi</h1>                              <nav class="main_nav">
    <ul>
                <li>
            <a title="Home Page"
                class="button home"
                href="/index.html">
                Home
            </a>
        </li>        <li>
            <a title="Research"
                class="button research"
                href="/research">
                Research
            </a>
        </li>        <li>
            <a title="Blog"
                class="button blog"
                href="/blog">
                Blog
            </a>
        </li>        <li>
            <a title="Software"
                class="button active software"
                href="/software">
                Software
            </a>
        </li>        <li>
            <a title="Misc"
                class="button misc"
                href="/misc">
                Me &amp; My ...
            </a>
        </li>    </ul>
</nav>
                    <div id="googletranslate" style="position:absolute;right:20px;bottom:5px"></div>
          </header>
          <div class="content-back">
          <div class="green-vline"></div>
          <div class="content-right">
                    <div class="right-float"><div id="sociallinks" style="font-size:10px;">
          </div></div>
          </div>
          <div class="contentwrapper">
          <section class="content">
          <article class="post">

<a href="/software">Software</a> &nbsp;&gt;&nbsp; An Unofficial "Bugfix" for QSlim 2.1<br/>
<nav class="postnav before">
Previous:
<a href="/software/tsinghua-classroom.html">Tsinghua Classroom</a>
<br/>

Next:
<a href="/software/undergrad-proj.html">Undergraduate Projects</a>
</nav>

<div class="title"><h1>
    An Unofficial "Bugfix" for QSlim 2.1
</h1></div>

<div class="postcontent">
<link rel="stylesheet" href="/media/css/syntaxhighlighter/shCoreEclipse.css" type="text/css">
<link rel="stylesheet" href="/media/css/syntaxhighlighter/shThemeEclipse.css" type="text/css">

<script src="/media/js/syntaxhighlighter/shCore.js"></script>
<script src="/media/js/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript">SyntaxHighlighter.all()</script>

<p>
<span style="color:#f00">Note: The method of this post is too naive to be applied in sophisticated
applications. So please think twice before applying it to yours.</span><br>

<a href="http://mgarland.org/software/qslim21.html" target="_blank">QSlim</a> is a 
light-weight software developed by <a href="http://mgarland.org" target="_blank">M. Garland</a>, 
which can simplify mesh models swiftly, maximally preserving their geodesic properties. 
However, in my recent use of it I discovered a &#8220;bug&#8221; regarding redundant&nbsp;faces.</p>

<p>
<a class="fancyimg" href="/media/images/software/bugfix-qslim-21/qslim.jpg">
<img src="/media/images/software/bugfix-qslim-21/qslim.jpg" width="400"></a>
I generated a L shape whose faces consist of redundant triangle mesh (figure left). However, 
after QSlim, the result is as the middle picture shows. The shape is damaged and faces 
are &#8220;out&#8221; of the original shape. I fixed the problem and my result is as the right 
picture shows. There exists known problems (it seems that some faces are facing the 
inside), but the major problem is resolved for redundant&nbsp;models.
</p>

<p>
When debugging Garland&#8217;s program, I found that in the project MixKit, the main QSlim file 
MxQSlim.cxx encounters the following problem: sometimes the optimized new point of a 
contracting edge causes an error that&#8217;s negative, which is obviously unreasonable. So 
I punished this error, and made an small adjustment to ensure that even error is zero, 
the area factor of quadrics still works. For details and compiled version, see 
<a href="#resources">Resources</a>.
</p>

<p>
I may update this bugfix later when I have time, to fix the known problem 
of face&nbsp;direction.
</p>

<div class="title"><a name="resources"></a><h2>Resources</h2></div>
<p>
For windows users, please feel free to download the compiled &#8220;bugfixed&#8221; QSlim 2.1 
<a href="/media/files/bugfix-qslim-21/qslim.zip">qslim.zip</a>
</p>
<p>
For people using other platforms or people wanting to compile on their own, I added 
these code to the MxQSlim.cxx file, at about Line 374, in function <code class="brush: cpp">void 
MxEdgeQSlim::compute_target_placement(MxQSlimEdge *info)</code>, just after the big&nbsp;if-else:
</p>
<pre class="brush: cpp">
if (e_min &lt; 0) e_min += 1e200; // The punishment of negative error, make it a great positive error
e_min += 1e-10 * Q.area();  // Make sure that area works even the error is zero
</pre>

<div class="title"><h2>See&nbsp;Also&#8230;</h2></div>
<p>
Read my blog and find out how I compiled QSlim 2.1 with Garland&#8217;s outdated .dsw file under 
<a href="/blog/compiling-qslim-21.html">Windows + Visual Studio</a>.
</p></div>

<nav class="postnav after">
Previous:
<a href="/software/tsinghua-classroom.html">Tsinghua Classroom</a>
<br/>

Next:
<a href="/software/undergrad-proj.html">Undergraduate Projects</a>
</nav>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'pengqishomepage'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</article>          </section>
          </div>
          </div>
      </div>
      </div> <!--! end of #container -->
  <footer>
      <div id="designlogo"><a href="http://qipeng.github.com/misc/homepage.html" target="_blank"><span style="color:#11bb22;">Designed</span>by<br>
    <span style="padding-left:40px">Qi<span style="color:#11bb22;">Peng</span></span></a>
    <br><span style="font-size:10px;text-align:center;">Powered by <a href="http://hyde.github.com/" target="_blank" class="hyde">hyde</a>.</span></div>
      <p style="text-align:center">&copy; <a href="http://qipeng.github.com/">Peng Qi</a>, 2012. Hosted by <a href="http://www.github.com">GitHub</a>.</p>
  </footer>
      <!-- Javascript at the bottom for fast page loading -->
    <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
  <script>window.jQuery || document.write('<script src="/media/js/libs/jquery-1.7.2.min.js">\x3C/script>')</script>
  
  <script type="text/javascript" src="/media/js/fancybox/jquery.fancybox-1.3.4.js"></script>
  <script type="text/javascript" src="/media/js/main.js"></script>
  <script type="text/javascript">$(function(){loadimg();loadgoogletranslate();loadsociallinks();})</script>
  <script src="/media/js/syntaxhighlighter/shCore.js"></script>
<script src="/media/js/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript">SyntaxHighlighter.all()</script>

  <!--[if lt IE 7 ]>
    <script src="/media/js/libs/dd_belatedpng.js"></script>
    <script>DD_belatedPNG.fix('img, .png_bg'); // Fix any <img> or .png_bg bg-images. Also, please read goo.gl/mZiyb </script>
  <![endif]-->﻿<script>
    var _gaq = [['_setAccount', 'UA-26770326-1'], ['_trackPageview']];
    (function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.async = true;
    g.src = ('https:' == location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g, s);
    })(document, 'script');
</script>
  </body>
</html>