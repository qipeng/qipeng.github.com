<!DOCTYPE html>
<html lang="en" class="yui3-js-enabled" itemscope itemtype="http://schema.org/Thing">
<head>
   <meta charset="utf-8">

  <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=utf8" />
  <meta name="robots" content="all" />
  <meta name="googlebot" content="all" />

  <title>An Unofficial "Bugfix" for QSlim 2.1</title>
  <meta name="description" content="A bugfix for QSlim 2.1, resolving the problem of redundant planes.
">
  <meta name="keywords" content="">
  <meta name="author" content="Peng Qi">

  <!--  Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.4.2/pure.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="/media/css/syntax.css" type="text/css">
  <link rel="stylesheet" href="/media/js/fancybox/jquery.fancybox.css" type="text/css">
  <link rel="stylesheet" href="/media/css/main-grid.css" type="text/css">
  <!--[if lte IE 8]>

    <link rel="stylesheet" href="http://yui.yahooapis.com/pure//grids-responsive-old-ie.css">

<![endif]-->
<!--[if gt IE 8]><!-->

    <link rel="stylesheet" href="http://yui.yahooapis.com/pure//grids-responsive.css">

<!--<![endif]-->
<!--[if lte IE 8]>
      <link rel="stylesheet" href="/media/css/layouts/marketing-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
      <link rel="stylesheet" href="/media/css/layouts/marketing.css">
  <!--<![endif]-->
  <script type="text/javascript" src="/media/js/main.js"></script>

  <link rel="stylesheet" href="/media/css/syntaxhighlighter/shCoreEclipse.css" type="text/css">
<link rel="stylesheet" href="/media/css/syntaxhighlighter/shThemeEclipse.css" type="text/css">


  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="media/js/html5shiv.js"></script>
  <![endif]-->

    <!-- Fav and touch icons -->
  <link rel="shortcut icon" href="/favicon.ico">
  
        <link rel="stylesheet" href="/media/css/site.css" type="text/css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>

<body>

<div class="header">
    <div class="home-menu pure-menu pure-menu-open pure-menu-horizontal pure-menu-fixed" id='header-menu'>
        <a class="pure-menu-heading" href="/index.html">Peng Qi</a>

                <ul class="nav">
                <li class="nav-item ">
            <a title="Research"
                class="research"
                href="/research">
                Research
            </a>
        </li>        <li class="nav-item ">
            <a title="Blog"
                class="blog"
                href="/blog">
                Blog
            </a>
        </li>        <li class="nav-item pure-menu-selected">
            <a title="Software"
                class="active software"
                href="/software">
                Software
            </a>
        </li>    </ul>
    </div>
</div>

<div id="layout" class="pure-g">

    <div class="content pure-u-1 pure-u-med-3-4">
        <div>
            <!-- A wrapper for all the blog posts -->
            <div class="posts">
                        <section>
            <article class="post">

<div class="title"><h1 itemprop="name">
    An Unofficial &#8220;Bugfix&#8221; for QSlim&nbsp;2.1
</h1></div>


<div class="postcontent">
<p><link rel="stylesheet" href="/media/css/syntaxhighlighter/shCoreEclipse.css" type="text/css">
<link rel="stylesheet" href="/media/css/syntaxhighlighter/shThemeEclipse.css" type="text/css"></p>
<script src="/media/js/syntaxhighlighter/shCore.js"></script>

<script src="/media/js/syntaxhighlighter/shBrushCpp.js"></script>

<script type="text/javascript">SyntaxHighlighter.all()</script>

<p>
<span style="color:#f00">Note: The method of this post is too naive to be applied in sophisticated
applications. So please think twice before applying it to yours.</span><br>

<a href="http://mgarland.org/software/qslim21.html" target="_blank">QSlim</a> is a 
light-weight software developed by <a href="http://mgarland.org" target="_blank">M. Garland</a>, 
which can simplify mesh models swiftly, maximally preserving their geodesic properties. 
However, in my recent use of it I discovered a &#8220;bug&#8221; regarding&nbsp;redundant&nbsp;faces.</p>

<p>
<a class="fancyimg" href="/media/images/software/bugfix-qslim-21/qslim.jpg">
<img src="/media/images/software/bugfix-qslim-21/qslim.jpg" width="400"></a>
I generated a L shape whose faces consist of redundant triangle mesh (figure left). However, 
after QSlim, the result is as the middle picture shows. The shape is damaged and faces 
are &#8220;out&#8221; of the original shape. I fixed the problem and my result is as the right 
picture shows. There exists known problems (it seems that some faces are facing the 
inside), but the major problem is resolved for&nbsp;redundant&nbsp;models.
</p>

<p>
When debugging Garland&#8217;s program, I found that in the project MixKit, the main QSlim file 
MxQSlim.cxx encounters the following problem: sometimes the optimized new point of a 
contracting edge causes an error that&#8217;s negative, which is obviously unreasonable. So 
I punished this error, and made an small adjustment to ensure that even error is zero, 
the area factor of quadrics still works. For details and compiled version, see 
<a href="#resources">Resources</a>.
</p>

<p>
I may update this bugfix later when I have time, to fix the known problem 
of&nbsp;face&nbsp;direction.
</p>

<div class="title"><a name="resources"></a><h2>Resources</h2></div>

<p>
For windows users, please feel free to download the compiled &#8220;bugfixed&#8221; QSlim 2.1 
<a href="bugfix-qslim-21/qslim.zip">qslim.zip</a>
</p>

<p>
For people using other platforms or people wanting to compile on their own, I added 
these code to the MxQSlim.cxx file, at about Line 374, in function <code class="brush: cpp">void 
MxEdgeQSlim::compute_target_placement(MxQSlimEdge *info)</code>, just after the&nbsp;big&nbsp;if-else:
</p>

<pre class="brush: cpp">
if (e_min &lt; 0) e_min += 1e200; // The punishment of negative error, make it a great positive error
e_min += 1e-10 * Q.area();  // Make sure that area works even the error is zero
</pre>

<div class="title"><h2>See&nbsp;Also&#8230;</h2></div>

<p>
Read my blog and find out how I compiled QSlim 2.1 with Garland&#8217;s outdated .dsw file under 
<a href="/blog/compiling-qslim-21.html">Windows + Visual Studio</a>.
</p></div>

<div style="float:left"><span class="lighter">Previous Post</span>&nbsp;
<a href="/software/tsinghua-classroom.html">Tsinghua Classroom</a>
</div>

<div style="float:right"><span class="lighter">Next Post</span>&nbsp;
<a href="/software/undergrad-proj.html">Undergraduate Projects</a>
</div>
<br>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'pengqishomepage'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</article>            </section>
                        <div class="footer">
                <div id="sociallinks" class="clear" style="font-size:10px;"></div>
                <div class="pure-menu pure-menu-horizontal pure-menu-open">
                    <ul>
                        <li><a href="https://purecss.io/">Copyright &copy; Peng Qi, 2019</a></li>
                        <li><a href="https://github.com/qipeng/">GitHub</a></li>
                        <li><a href="https://twitter.com/qi2peng2">Twitter</a></li>
                        <li><a href="https://www.linkedin.com/pub/peng-qi/90/800/395/">LinkedIn</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script>
window.jQuery || document.write("<script src=\"/media/js/jquery.min.js\"><\/script>")
</script>
<script type="text/javascript" src="/media/js/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">$(function(){loadsociallinks();loadimg();});</script>

<script src="http://yui.yahooapis.com/3.14.1/build/yui/yui.js"></script>
<script>
YUI().use('node-base', 'node-event-delegate', function (Y) {
    // This just makes sure that the href="#" attached to the <a> elements
    // don't scroll you back up the page.
    Y.one('body').delegate('click', function (e) {
        e.preventDefault();
    }, 'a[href="#"]');
});

$(document).ready(function(){
$('#bibtex-modal').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget) // Button that triggered the modal
  var url = button.data('url') // Extract info from data-* attributes
  var modal = $(this)
  $.ajax({
    'url': url,
    'success': function(data) {
      modal.find('#bibtex-content').text(data)
    }
  })
});
})

</script>


</div>

  <!-- Javascript at the bottom for fast page loading -->

  <script src="/media/js/syntaxhighlighter/shCore.js"></script>
<script src="/media/js/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript">SyntaxHighlighter.all()</script>

  <!--[if lt IE 7 ]>
    <script src="/media/js/libs/dd_belatedpng.js"></script>
    <script>DD_belatedPNG.fix('img, .png_bg'); // Fix any <img> or .png_bg bg-images. Also, please read goo.gl/mZiyb </script>
  <![endif]--><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-26770326-1', 'qipeng.me');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>
  
    <script>
        var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
  var currentScrollPos = window.pageYOffset;
  if (prevScrollpos < currentScrollPos && prevScrollpos > 250) {
    document.getElementById("header-menu").style.top = "-50px";
  } else {
    document.getElementById("header-menu").style.top = "0px";
  }
  prevScrollpos = currentScrollPos;
}
window.onbeforeprint = function() {
  document.getElementById("header-menu").style.top = "0px";
}
    </script>

<div class="modal" id="bibtex-modal" tabindex="-1" role="dialog" aria-labelledby="bibtex-modal" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="bibtex-modal-title">BibTeX</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre id='bibtex-content'></pre>
      </div>
    </div>
  </div>
</div>

</body>
</html>