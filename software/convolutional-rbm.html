<!DOCTYPE html>
<html lang="en" class="yui3-js-enabled" itemscope itemtype="http://schema.org/Thing">
<head>
   <meta charset="utf-8">

  <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=utf8" />
  <meta name="robots" content="all" />
  <meta name="googlebot" content="all" />

  <title>ConvolutionalRBM.m</title>
  <meta name="description" content="A Matlab / MEX / CUDA-MEX implementation of Convolutional Restricted Boltzmann Machine (RBM).
">
  <meta name="keywords" content="">
  <meta name="author" content="Peng Qi">

  <!--  Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0;">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.4.2/pure.css">
  <link rel="stylesheet" href="/media/css/syntax.css" type="text/css">
  <link rel="stylesheet" href="/media/js/fancybox/jquery.fancybox-1.3.4.css" type="text/css">
  <link rel="stylesheet" href="/media/css/main-grid.css" type="text/css">
  <link rel="stylesheet" href="/media/css/layouts/blog.css" type="text/css">
  <link rel="stylesheet" href="/media/css/site.css" type="text/css">
  <script type="text/javascript" src="/media/js/main.js"></script>
   
  
  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="media/js/html5shiv.js"></script>
  <![endif]-->

    <!-- Fav and touch icons -->
  <link rel="shortcut icon" href="favicon.ico">
      
      </head>

<body>

<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-med-1-4">
        <div class="header">
            <hgroup>
                <h1 class="brand-title">Peng Qi</h1>
                <h2 class="brand-tagline">Research, Learn, Code, and Play.</h2>
            </hgroup>

            <nav class="nav">
                <ul class="nav-list">
                                    <ul class="nav">
                <li class="nav-item ">
            <a title="Home Page"
                class="pure-button home"
                href="/index.html">
                Home
            </a>
        </li>        <li class="nav-item ">
            <a title="Research"
                class="pure-button research"
                href="/research">
                Research
            </a>
        </li>        <li class="nav-item ">
            <a title="Blog"
                class="pure-button blog"
                href="/blog">
                Blog
            </a>
        </li>        <li class="nav-item active">
            <a title="Software"
                class="pure-button active software"
                href="/software">
                Software
            </a>
        </li>        <li class="nav-item ">
            <a title="Misc"
                class="pure-button misc"
                href="/misc">
                Me &amp; My ...
            </a>
        </li>    </ul>
                </ul>
            </nav>
        </div>
    </div>

    <div class="content pure-u-1 pure-u-med-3-4">
        <div>
            <!-- A wrapper for all the blog posts -->
            <div class="posts">
                        <section>
            <article class="post">

<div class="title"><h1 itemprop="name">
    ConvolutionalRBM.m
</h1></div>


<div class="postcontent">
<p>
When I was doing research on deep learning structures, I was amazed by convolutional <span class="caps">RBM</span> when I read about it because it possess the amazing capability of learning object parts and &#8220;recovering&#8221; missing parts (see <a href="#reference">Reference</a>). Although <a href="http://www.cs.utoronto.ca/~kriz/" target="_blank">Alex Krizhevsky</a> has an implementation of such network in pure <span class="caps">CUDA</span>, I think some (like myself) might want to use a more friendly Matlab version to process smaller amount of data with a bit more time-consumption &#8211; so here we&nbsp;are.</p>

<div class="title"><h3>Status</h3></div>

<p>
<table>
<tr><td><span class="lighter">Current Version</span></td><td>0.3</td></tr>
<tr><td><span class="lighter">Note (Feb. 7, 2014)</span></td><td>New <span class="caps">CPU</span> code updated for new data structure. <span class="caps">GPU</span> code will _not_ work. Some updates on help text, code comments, as well as mex option files. New nvmex option file for MacOS added.</td></tr>
<tr><td><span class="lighter">Important Note</span></td><td>This code is <span class="lighter">not</span> an official release by the authors and may contain defect resulting in erroneous outcome. Please use with caution and all possible losses is at the user&#8217;s own risk. For research / personal purposes only and should be kept public with this note. Feedbacks welcome below this post, and also in the <a href="https://github.com/qipeng/convolutionalRBM.m" target="_blank">project homepage</a>.</td></tr>
<tr><td><span class="lighter">Source code</span></td><td>Available at the <a href="https://github.com/qipeng/convolutionalRBM.m" target="_blank">project homepage</a></td></tr>
<tr><td><span class="lighter">Coding status</span></td><td>Under heavy development</a></td></tr>
<tr><td><span class="lighter">Update Log</span></td><td>
<table>
<tr><td><span class="lighter-color">Mar 31, 2014: </span></td><td><emph>Example code added</emph></td></tr>
<tr><td><span class="lighter-color">Feb 7, 2014: 0.3</span></td><td>Major change of data structure, <span class="caps">CPU</span> working version</td></tr>
<tr><td><span class="lighter-color">Nov 28, 2012: 0.2 alpha</span></td><td>Change of file names <span class="amp">&amp;</span> functions</td></tr>
<tr><td><span class="lighter-color">Oct 17, 2012: 0.1 alpha</span></td><td>Basic functionalities</td></tr>
</table>
</td></tr>
</table>
</p>

<div class="title"><h3>Experimental&nbsp;Results</h3></div>

<p>
Coming&nbsp;soon&#8230;
</p>

<div class="title"><h3>Known&nbsp;Issues</h3></div>

<p>
<ul class="news">
<li><span class='lighter'>The <span class="caps">CUDA</span> code might crash or produce rubbish results. </span> Although I make the best effort to keep the <span class="caps">CPU</span> code of this project clean and usable, I sometimes struggle to do the same for the <span class="caps">CUDA</span> code in the same timely manner. If that happens, please accept my deepest apologies and hang tight for my next&nbsp;release.</li>
<li><span class='lighter'>The <span class="caps">CUDA</span> code is currently not running properly (at all) on Mac <span class="caps">OS</span> 10.9.1. </span>This seems to be a general <span class="caps">CUDA</span> issue since the Mavericks update. Please sit tight before nVidia releases new drivers to save the&nbsp;world.</li>
<li><span class='lighter'>The <span class="caps">CUDA</span> code might not compile properly on Linux systems (Ubuntu, etc).</span> I don&#8217;t have a Linux system at hand set up with <span class="caps">CUDA</span> and everything for the moment to test the building scripts. But anyone&#8217;s help on this is very much&nbsp;welcomed.</li>
</ul>
</p>

<div class="title"><h3>FAQs <span class="amp">&amp;</span>&nbsp;Remarks</h3></div>

<p>
<ul class="news">
<li><span class="lighter">I can&#8217;t run the code. Functions not exist?</span><br>To run this code properly, run <span class="code">make</span>, and follow the instructions to setup your compiler for <span class="caps">MEX</span> to compile necessary <span class="caps">MEX</span>&nbsp;files.</li>
<li><span class="lighter">How to use your <span class="caps">CUDA</span>-<span class="caps">MEX</span>?</span><br>See <a href="http://www.cs.ucf.edu/~janaka/gpu/using_nvmex.htm" target="_blank">A Guide to Using <span class="caps">NVMEX</span> Tool</a>. I&#8217;ve modified the nvmexopts.bat file a bit to link the <span class="caps">CUDA</span> libs. <span class="code">make</span> will ask you whether you want to compile <span class="caps">CUDA</span> <span class="caps">MEX</span> files. This feature is limited by the <span class="code">nvmexopts.bat</span> file and currently only work under Win32. Some configuration of the bat file is needed, which is covered in the software documentation (to&nbsp;come).</li>
<li><span class="lighter">How fast can this code run?</span><br>I can&#8217;t say it runs fast: after all the current (0.1 alpha) backbone code is still implemented in Matlab. But with mex implementation, it&#8217;s about 5x faster than a pure Matlab implememtation. However since <span class="caps">CUDA</span>-<span class="caps">MEX</span> is not quite taken advantage of, the current version (0.1 alpha) using <span class="caps">CUDA</span>-<span class="caps">MEX</span> runs about 3x slower on my laptop, than the <span class="caps">MEX</span>&nbsp;version.</li>
<li><span class="lighter">I found a bug. Where do I report to?</span><br>Both commenting below this post and adding an issue at the <a href="https://github.com/qipeng/convolutionalRBM.m" target="_blank">project homepage</a> will&nbsp;do.</li>
<li><span class="lighter">Future development plans?</span><br>This code is still under heavy development before it&#8217;s usable in real-world applications instead of toy-sized problems. A full <span class="caps">MEX</span> / <span class="caps">CUDA</span>-<span class="caps">MEX</span> implementation is planned. Besides, a gadget script for compiling <span class="caps">MEX</span> / <span class="caps">CUDA</span>-<span class="caps">MEX</span> files, as well as sample data and usage, are&nbsp;considered.</li>
</ul>
</p>

<div class="title"><h3>References</h3></div>

<p>
You may want to cite the following publications when your research uses this code (like I said, this is *not* an official release by the authors so use caution):
<ul class="news">
<li><a href="http://ai.stanford.edu/~ang/papers/icml09-ConvolutionalDeepBeliefNetworks.pdf" target="_blank">Convolutional deep belief networks for scalable unsupervised learning of hierarchical representations</a>, Honglak Lee, Roger Grosse, Rajesh Ranganath and Andrew Y. Ng. In Proceedings of the Twenty-Sixth International Conference on Machine Learning,&nbsp;2009. </li>
<li><a href="http://www.cs.toronto.edu/~norouzi/research/papers/conv_rbm.pdf">Stacks of Convolutional Restricted Boltzmann Machines for Shift-Invariant Feature Learning</a>,
Mohammad Norouzi, Mani Ranjbar, Greg Mori,
<span class="caps">IEEE</span> Computer Vision and Pattern Recognition (<span class="caps">CVPR</span>),&nbsp;2009. </li>
</ul>
</p></div>

<div style="float:left"><span class="lighter">Previous Post</span>&nbsp;
<a href="/software/misc.html">Miscellaneous</a>
</div>

<div style="float:right"><span class="lighter">Next Post</span>&nbsp;
<a href="/software/tsinghua-classroom.html">Tsinghua Classroom</a>
</div>
<br>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'pengqishomepage'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</article>            </section>
                        <div class="footer">
                <div id="sociallinks" class="clear" style="font-size:10px;"></div>
                <div class="pure-menu pure-menu-horizontal pure-menu-open">
                    <ul>
                        <li><a href="http://purecss.io/">Copyright &copy; Peng Qi, 2014</a></li>
                        <li><a href="http://github.com/qipeng/">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<script type="text/javascript" src="/media/js/fancybox/jquery.fancybox-1.3.4.js"></script>
<script type="text/javascript">$(function(){loadsociallinks();loadimg();});</script>

<script src="http://yui.yahooapis.com/3.14.1/build/yui/yui.js"></script>
<script>
YUI().use('node-base', 'node-event-delegate', function (Y) {
    // This just makes sure that the href="#" attached to the <a> elements
    // don't scroll you back up the page.
    Y.one('body').delegate('click', function (e) {
        e.preventDefault();
    }, 'a[href="#"]');
});
</script>


</div>
  <!-- Javascript at the bottom for fast page loading -->

  
  <!--[if lt IE 7 ]>
    <script src="/media/js/libs/dd_belatedpng.js"></script>
    <script>DD_belatedPNG.fix('img, .png_bg'); // Fix any <img> or .png_bg bg-images. Also, please read goo.gl/mZiyb </script>
  <![endif]--><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-26770326-1', 'github.com');
  ga('send', 'pageview');

</script>
  
</body>
</html>