<html lang="en"><head><meta charset="utf-8"><!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame Remove this if you use the .htaccess --><meta http-equiv="X-UA-Compatible" content=""><meta http-equiv="Content-Type" content="text/html; charset=utf8" /><meta name="robots" content="all" /><meta name="googlebot" content="all" /><title>Limited-Memory Multinomial Logistic Regression Classifier for Matlab</title><meta name="description" content="An limited-memory implementation of multinomial logistic regression classifier for Matlab "><meta name="keywords" content=""><meta name="author" content="Peng Qi"><!-- Mobile viewport optimized: j.mp/bplateviewport --><meta name="viewport" content=""><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/media/css/site.css" type="text/css"><link rel="stylesheet" href="/media/css/syntax.css" type="text/css"><link rel="stylesheet" href="/media/js/fancybox/jquery.fancybox-1.3.4.css" type="text/css"><!-- All JavaScript at the bottom, except for Modernizr which enables HTML5 elements & feature detects --><script type="text/javascript" src="/media/js/libs/modernizr-1.7.min.js"></script></head><body id="mnlr"><div id="container"><div id="main" role="main"><header class="banner clearfix"><h1>Peng Qi</h1><nav class="main_nav"><ul><li><a title="Home Page" class="button home" href="/index.html"> Home </a></li><li><a title="Research" class="button research" href="/research"> Research </a></li><li><a title="Blog" class="button blog" href="/blog"> Blog </a></li><li><a title="Software" class="button active software" href="/software"> Software </a></li><li><a title="Misc" class="button misc" href="/misc"> Me &amp; My ... </a></li></ul></nav><div id="googletranslate" style="position:absolute;right:20px;bottom:5px"></div></header><div class="content-back"><div class="green-vline"></div><div class="content-right"><div class="right-float"><div id="sociallinks" style="font-size:10px;"></div></div></div><div class="contentwrapper"><section class="content"><article class="post"><a href="/software">Software</a> &nbsp;&gt;&nbsp; Limited-Memory Multinomial Logistic Regression Classifier for Matlab<br/><nav class="postnav before"> Previous: None <br/> Next: <a href="/software/misc.html">Miscellaneous</a></nav><div class="title"><h1> Limited-Memory Multinomial Logistic Regression Classifier for Matlab </h1></div><div class="postcontent"><p> When using Matlab&#8217;s <code>mnrfit</code> to train a multinomial logistic regression classifier recently, I found it rather memory-consuming.&nbsp;Specifically, when training a classifier with thousands of samples and tens of thousands of samples, it used up the <span class="caps">32GB</span> of <span class="caps">RAM</span> on a workstation and forced it to maintain considerable virtual memory. What should&#8217;ve been a <span class="caps">CPU</span>-bound problem then became a <span class="caps">HDD</span>-bound problem, and I never received my result (it just took tooooo&nbsp;long). </p><p> After reading about the awesome optimization code <a href="http://www.di.ens.fr/~mschmidt/Software/minFunc.html" target="_blank">minFunc</a>, I decided to implement a classifier on my own. Thanks to minFunc and its examples, I can finish this little piece of code and publish it&nbsp;here. </p><p><div class="title"><h3>Setup <span class="amp">&amp;</span>&nbsp;Usage</h3></div> The user will have to download the <a href="http://www.di.ens.fr/~mschmidt/Software/minFunc.html" target="_blank">minFunc</a> from their website, and make sure it&#8217;s working. That is, you may need to add the directory of minFunc to Matlab path (e.g. <code>addpath('./minFunc')</code>), run <code>mexAll</code>, which might be required the first time you use it. Then, add all minFunc&#8217;s subdirectories to your Matlab path (e.g. <code>addpath(genpath('./minFunc'))</code>) and you&#8217;ll be able to run the following test case.<br><br><pre class="code"> >> x = repmat(eye(3),[10 1]); y = repmat([1;2;3],[10 1]); x = x + 0.1*randn(size(x)); >> model = mnlr_fit(x, y); >> prediction = mnlr_predict(model, x, 1); >> sum(prediction == y) / length(y) ans = 1 </pre> That is, we just trained our 3-way classifier on a small dataset of 30 samples and achieved 100% training&nbsp;accuracy. </p><p><div class="title"><h3>Setup <span class="amp">&amp;</span>&nbsp;Usage</h3></div> Source code files: <ul class="news"><li><a href="mnlr/mnlr_fit.m" target="_blank">mnlr_fit.m</a></li><li><a href="mnlr/mnlr_predict.m" target="_blank">mnlr_predict.m</a></li></ul></p></div><nav class="postnav after"> Previous: None <br/> Next: <a href="/software/misc.html">Miscellaneous</a></nav><div id="disqus_thread"></div><script type="text/javascript"> /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */ var disqus_shortname = 'pengqishomepage'; // required: replace example with your forum shortname /* * * DON'T EDIT BELOW THIS LINE * * */ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a></article></section></div></div></div></div><!--! end of #container --><footer><div id="designlogo"><a href="http://qipeng.github.com/misc/homepage.html" target="_blank"><span style="color:#11bb22;">Designed</span>by<br><span style="padding-left:40px">Qi<span style="color:#11bb22;">Peng</span></span></a><br><span style="font-size:10px;text-align:center;">Powered by <a href="http://hyde.github.com/" target="_blank" class="hyde">hyde</a>.</span></div><p style="text-align:center">&copy; <a href="http://qipeng.github.com/">Peng Qi</a>, 2012. Hosted by <a href="http://www.github.com">GitHub</a>.</p></footer><!-- Javascript at the bottom for fast page loading --><!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary --><script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script><script>window.jQuery || document.write('<script src="/media/js/libs/jquery-1.7.2.min.js">\x3C/script>')</script><script type="text/javascript" src="/media/js/fancybox/jquery.fancybox-1.3.4.js"></script><script type="text/javascript" src="/media/js/main.js"></script><script type="text/javascript">$(function(){loadimg();loadgoogletranslate();loadsociallinks();})</script><!--[if lt IE 7 ]><script src="/media/js/libs/dd_belatedpng.js"></script><script>DD_belatedPNG.fix('img, .png_bg'); // Fix any <img> or .png_bg bg-images. Also, please read goo.gl/mZiyb </script><![endif]--><script> var _gaq = [['_setAccount', 'UA-26770326-1'], ['_trackPageview']]; (function(d, t) { var g = d.createElement(t), s = d.getElementsByTagName(t)[0]; g.async = true; g.src = ('https:' == location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; s.parentNode.insertBefore(g, s); })(document, 'script'); </script></body></html> 
